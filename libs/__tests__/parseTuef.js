import {
  parseFixedLengthSegment,
  parseVaryLengthSegment,
  parseTuef,
} from '../parseTuef'

describe('parseTuef', () => {
  describe('parseFixedLengthSegment', () => {
    it('Parses fixed length segment', () => {
      const spec = {
        lengthType: 'fixed',
        fieldSpecs: [
          {
            name: 'fieldA',
            length: 3,
            type: 'N',
          },
          {
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = '003Hell      '
      const { obj, parsedChar } = parseFixedLengthSegment(spec, str)

      expect(obj).toEqual({ fieldA: 3, fieldB: 'Hell' })
      expect(parsedChar).toEqual(13)
    })
    it('Throw error if field value does not have correct type', () => {
      const spec = {
        lengthType: 'fixed',
        fieldSpecs: [
          {
            name: 'fieldA',
            length: 3,
            type: 'N',
          },
          {
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = '00AHell      '
      expect(() => {
        parseFixedLengthSegment(spec, str)
      }).toThrowError()
    })
  })
  describe('parseVaryLengthSegment', () => {
    it('Parses vary length segment', () => {
      const spec = {
        lengthType: 'vary',
        fieldSpecs: [
          {
            tag: 'PN',
            name: 'fieldA',
            length: 30,
            type: 'N',
          },
          {
            tag: '01',
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = 'PN02030110Hell      '
      const { obj, parsedChar } = parseVaryLengthSegment(spec, str)

      expect(obj).toEqual({ fieldA: 3, fieldB: 'Hell' })
      expect(parsedChar).toEqual(20)
    })
    it('Parses vary length segment with optional fields', () => {
      const spec = {
        lengthType: 'vary',
        fieldSpecs: [
          {
            tag: 'PN',
            name: 'fieldA',
            length: 30,
            type: 'N',
          },
          {
            tag: 'MS',
            name: 'optionalField',
            length: 5,
            type: 'AN',
          },
          {
            tag: '01',
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = 'PN02030110Hell      '
      const { obj, parsedChar } = parseVaryLengthSegment(spec, str)

      expect(obj).toEqual({ fieldA: 3, fieldB: 'Hell' })
      expect(parsedChar).toEqual(20)
    })
    it('Throw error if tag property is missing from fieldSpec', () => {
      const spec = {
        lengthType: 'vary',
        fieldSpecs: [
          {
            tag: 'PN',
            name: 'fieldA',
            length: 3,
            type: 'N',
          },
          {
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = 'PN02030110Hell      '
      expect(() => {
        parseVaryLengthSegment(spec, str)
      }).toThrowError()
    })
    it('Throw error if length property cannot be converted to a number', () => {
      const spec = {
        lengthType: 'vary',
        fieldSpecs: [
          {
            tag: 'PN',
            name: 'fieldA',
            length: 3,
            type: 'N',
          },
          {
            tag: '01',
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = 'PNA2030110Hell      ' // Specified A2 as length
      expect(() => {
        parseVaryLengthSegment(spec, str)
      }).toThrowError()
    })
    it('Throw error if field value does not have correct type', () => {
      const spec = {
        lengthType: 'vary',
        fieldSpecs: [
          {
            tag: 'PN',
            name: 'fieldA',
            length: 3,
            type: 'N',
          },
          {
            tag: '01',
            name: 'fieldB',
            length: 10,
            type: 'A',
          },
        ],
      }
      const str = 'PN02A30110Hell      '
      expect(() => {
        parseFixedLengthSegment(spec, str)
      }).toThrowError()
    })
  })
  describe('parseTuef', () => {
    it('Parses simple tuef', () => {
      const spec = {
        header: {
          lengthType: 'fixed',
          fieldSpecs: [
            {
              name: 'segmentTag',
              length: 4,
              type: 'A',
            },
            {
              name: 'version',
              length: 2,
              type: 'N',
            },
            {
              name: 'memberReferenceNo',
              length: 25,
              type: 'AN',
            },
            {
              name: 'country',
              length: 2,
              type: 'A',
            },
            {
              name: 'memberCode',
              length: 10,
              type: 'AN',
            },
            {
              name: 'subjectReferenceCode',
              length: 1,
              type: 'N',
            },
            {
              name: 'enquiryControlNumber',
              length: 9,
              type: 'N',
            },
          ],
        },
        PN: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'PN',
              name: 'segmentTag',
              length: 3,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'lastName1',
              length: 50,
              type: 'A',
            },
            {
              tag: '02',
              name: 'lastName2',
              length: 26,
              type: 'A',
            },
            {
              tag: '04',
              name: 'firstName',
              length: 30,
              type: 'A',
            },
            {
              tag: '05',
              name: 'middle',
              length: 26,
              type: 'A',
            },
            {
              tag: '06',
              name: 'maritalStatus',
              length: 4,
              type: 'N',
            },
            {
              tag: '07',
              name: 'dateOfBirth',
              length: 8,
              type: 'N',
            },
            {
              tag: '08',
              name: 'gender',
              length: 1,
              type: 'N',
            },
            {
              tag: '09',
              name: 'title',
              length: 15,
              type: 'P',
            },
            {
              tag: '10',
              name: 'nationality',
              length: 2,
              type: 'P',
            },
            {
              tag: '11',
              name: 'numberOfChildren',
              length: 2,
              type: 'N',
            },
            {
              tag: '12',
              name: 'spouseName',
              length: 45,
              type: 'A',
            },
            {
              tag: '13',
              name: 'occupation',
              length: 1,
              type: 'A',
            },
            {
              tag: '14',
              name: 'consentToEnquire',
              length: 1,
              type: 'A',
            },
          ],
        },
      }
      const str =
        'TUEF14                         THCC160280011493566856PN03N010105·´ÊÍº0406ÊÁÁØµÔ070825110515080121401YID03'
      const expected = {
        PN: [
          {
            consentToEnquire: 'Y',
            dateOfBirth: 25110515,
            firstName: 'สมมุติ',
            gender: 2,
            lastName1: 'ทดสอบ',
            segmentTag: 'N01',
          },
        ],
        header: {
          country: 'TH',
          enquiryControlNumber: 493566856,
          memberCode: 'CC16028001',
          memberReferenceNo: '',
          segmentTag: 'TUEF',
          subjectReferenceCode: 1,
          version: 14,
        },
      }
      expect(parseTuef(spec, str)).toEqual(expected)
    })
    it('Parses nested segment tuef', () => {
      const spec = {
        header: {
          lengthType: 'fixed',
          fieldSpecs: [
            {
              name: 'segmentTag',
              length: 4,
              type: 'A',
            },
            {
              name: 'version',
              length: 2,
              type: 'N',
            },
            {
              name: 'memberReferenceNo',
              length: 25,
              type: 'AN',
            },
            {
              name: 'country',
              length: 2,
              type: 'A',
            },
            {
              name: 'memberCode',
              length: 10,
              type: 'AN',
            },
            {
              name: 'subjectReferenceCode',
              length: 1,
              type: 'N',
            },
            {
              name: 'enquiryControlNumber',
              length: 9,
              type: 'N',
            },
          ],
        },
        PN: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'PN',
              name: 'segmentTag',
              length: 3,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'lastName1',
              length: 50,
              type: 'A',
            },
            {
              tag: '02',
              name: 'lastName2',
              length: 26,
              type: 'A',
            },
            {
              tag: '04',
              name: 'firstName',
              length: 30,
              type: 'A',
            },
            {
              tag: '05',
              name: 'middle',
              length: 26,
              type: 'A',
            },
            {
              tag: '06',
              name: 'maritalStatus',
              length: 4,
              type: 'N',
            },
            {
              tag: '07',
              name: 'dateOfBirth',
              length: 8,
              type: 'N',
            },
            {
              tag: '08',
              name: 'gender',
              length: 1,
              type: 'N',
            },
            {
              tag: '09',
              name: 'title',
              length: 15,
              type: 'P',
            },
            {
              tag: '10',
              name: 'nationality',
              length: 2,
              type: 'P',
            },
            {
              tag: '11',
              name: 'numberOfChildren',
              length: 2,
              type: 'N',
            },
            {
              tag: '12',
              name: 'spouseName',
              length: 45,
              type: 'A',
            },
            {
              tag: '13',
              name: 'occupation',
              length: 1,
              type: 'AN', // sometime occupation return 0
            },
            {
              tag: '14',
              name: 'consentToEnquire',
              length: 1,
              type: 'A',
            },
          ],
        },
        ID: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'ID',
              name: 'segmentTag',
              length: 3,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'idType',
              length: 2,
              type: 'N',
            },
            {
              tag: '02',
              name: 'idNumber',
              length: 20,
              type: 'P',
            },
            {
              tag: '03',
              name: 'idIssueCountry',
              length: 2,
              type: 'A',
            },
          ],
        },
        PA: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'PA',
              name: 'segmentTag',
              length: 3,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'addressLine1',
              length: 45,
              type: 'P',
            },
            {
              tag: '02',
              name: 'addressLine2',
              length: 45,
              type: 'P',
            },
            {
              tag: '03',
              name: 'addressLine3',
              length: 45,
              type: 'P',
            },
            {
              tag: '04',
              name: 'subDistrict',
              length: '40',
              type: 'P',
            },
            {
              tag: '05',
              name: 'district',
              length: '40',
              type: 'P',
            },
            {
              tag: '06',
              name: 'province',
              length: '40',
              type: 'P',
            },
            {
              tag: '07',
              name: 'country',
              length: '4',
              type: 'A',
            },
            {
              tag: '08',
              name: 'postalCode',
              length: 10,
              type: 'N',
            },
            {
              tag: '09',
              name: 'telephone',
              length: 20,
              type: 'P',
            },
            {
              tag: '10',
              name: 'telephoneType',
              length: 1,
              type: 'A',
            },
            {
              tag: '11',
              name: 'addressType',
              length: 1,
              type: 'A',
            },
            {
              tag: '12',
              name: 'residentialStatus',
              length: 1,
              type: 'A',
            },
            {
              tag: '13',
              name: 'reportedDate',
              length: 8,
              type: 'N',
            },
          ],
        },
        TL: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'TL',
              name: 'segmentTag',
              length: 4,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'memberCode',
              length: 10,
              type: 'AN',
            },
            {
              tag: '02',
              name: 'memberShortName',
              length: 25,
              type: 'P',
            },
            {
              tag: '03',
              name: 'accountNo',
              length: 25,
              type: 'AN',
            },
            {
              tag: '04',
              name: 'accountType',
              length: 2,
              type: 'N',
            },
            {
              tag: '05',
              name: 'ownershipIndicator',
              length: 1,
              type: 'AN',
            },
            {
              tag: '06',
              name: 'currencyCode',
              length: 3,
              type: 'A',
            },
            {
              tag: '08',
              name: 'dateAccountOpened',
              length: 8,
              type: 'N',
            },
            {
              tag: '09',
              name: 'dateOfLastPayment',
              length: 8,
              type: 'N',
            },
            {
              tag: '10',
              name: 'dateAccountClosed',
              length: 8,
              type: 'N',
            },
            {
              tag: '11',
              name: 'asOfDate',
              length: 8,
              type: 'N',
            },
            {
              tag: '12',
              name: 'creditLimit',
              length: 9,
              type: 'N',
            },
            {
              tag: '13',
              name: 'amountOwed',
              length: 9,
              type: 'N',
            },
            {
              tag: '14',
              name: 'amountPastDue',
              length: 9,
              type: 'N',
            },
            {
              tag: '19',
              name: 'defaultDate',
              length: 8,
              type: 'N',
            },
            {
              tag: '20',
              name: 'installmentFreq',
              length: 1,
              type: 'N',
            },
            {
              tag: '21',
              name: 'installmentAmount',
              length: 9,
              type: 'N',
            },
            {
              tag: '22',
              name: 'installmentNumberOfPayment',
              length: 4,
              type: 'N',
            },
            {
              tag: '23',
              name: 'accountStatus',
              length: 2,
              type: 'N',
            },
            {
              tag: '28',
              name: 'paymentHistory1',
              length: 54,
              type: 'AN',
            },
            {
              tag: '29',
              name: 'paymentHistory2',
              length: 54,
              type: 'AN',
            },
            {
              tag: '30',
              name: 'paymentHistoryStartDate',
              length: 8,
              type: 'N',
            },
            {
              tag: '31',
              name: 'paymentHistoryEndDate',
              length: 8,
              type: 'N',
            },
            {
              tag: '32',
              name: 'loanObjective',
              length: 5,
              type: 'N',
            },
            {
              tag: '33',
              name: 'collateral1',
              length: 3,
              type: 'N',
            },
            {
              tag: '34',
              name: 'collateral2',
              length: 3,
              type: 'N',
            },
            {
              tag: '35',
              name: 'collateral3',
              length: 3,
              type: 'N',
            },
            {
              tag: '36',
              name: 'dateOfLastDebtRestructure',
              length: 8,
              type: 'N',
            },
            {
              tag: '37',
              name: 'percentPayment',
              length: '5',
              type: 'N',
            },
            {
              tag: '38',
              name: 'typeOfCreditCard',
              length: 2,
              type: 'N',
            },
            {
              tag: '39',
              name: 'numberOfCoborrower',
              length: 2,
              type: 'N',
            },
            {
              tag: '40',
              name: 'unitMake',
              length: 15,
              type: 'AN',
            },
            {
              tag: '41',
              name: 'unitModel',
              length: 15,
              type: 'AN',
            },
            {
              tag: '42',
              name: 'creditTypeFlag',
              length: 3,
              type: 'AN',
            },
          ],
          childSegment: {
            HS: {
              lengthType: 'vary',
              fieldSpecs: [
                {
                  tag: 'HS',
                  name: 'segmentTag',
                  length: 4,
                  type: 'AN',
                },
                {
                  tag: '01',
                  name: 'asOfDate',
                  length: 8,
                  type: 'N',
                },
                {
                  tag: '02',
                  name: 'overDueMonth',
                  length: 3,
                  type: 'AN',
                },
                {
                  tag: '03',
                  name: 'creditLimit',
                  length: 9,
                  type: 'N',
                },
                {
                  tag: '04',
                  name: 'amountOwed',
                  length: 9,
                  type: 'N',
                },
              ],
            },
          },
        },
        IQ: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'IQ',
              name: 'segmentTag',
              length: 4,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'dateOfEnquiry',
              length: 8,
              type: 'N',
            },
            {
              tag: '02',
              name: 'timeOfEnquiry',
              length: 6,
              type: 'N',
            },
            {
              tag: '03',
              name: 'memberCode',
              length: 10,
              type: 'AN',
            },
            {
              tag: '04',
              name: 'memberCodeShortName',
              length: 25,
              type: 'A',
            },
            {
              tag: '05',
              name: 'enquiryPurpose',
              length: 2,
              type: 'N',
            },
            {
              tag: '06',
              name: 'enquiryAmount',
              length: 9,
              type: 'N',
            },
            {
              tag: '07',
              name: 'currencyCode',
              length: 3,
              type: 'A',
            },
          ],
        },
        DR: {
          lengthType: 'vary',
          fieldSpecs: [
            {
              tag: 'DR',
              name: 'segmentTag',
              length: 3,
              type: 'AN',
            },
            {
              tag: '01',
              name: 'refSegmentType',
              length: 2,
              type: 'AN',
            },
            {
              tag: '02',
              name: 'refSegmentTag',
              length: 4,
              type: 'AN',
            },
            {
              tag: '03',
              name: 'disputeCode',
              length: 4,
              type: 'AN',
            },
            {
              tag: '04',
              name: 'disputeDate',
              length: 8,
              type: 'N',
            },
            {
              tag: '05',
              name: 'disputeTime',
              length: 6,
              type: 'N',
            },
            {
              tag: '06',
              name: 'disputeRemark1',
              length: 90,
              type: 'P',
            },
            {
              tag: '07',
              name: 'disputeRemark2',
              length: 90,
              type: 'P',
            },
            {
              tag: '08',
              name: 'disputeRemark3',
              length: 90,
              type: 'P',
            },
            {
              tag: '09',
              name: 'disputeRemark4',
              length: 90,
              type: 'P',
            },
            {
              tag: '10',
              name: 'disputeRemark5',
              length: 90,
              type: 'P',
            },
            {
              tag: '11',
              name: 'disputeRemark6',
              length: 90,
              type: 'P',
            },
          ],
        },
      }

      
      const str =
        'TUEF14                         THCC160210021582345217PN03N010106HAOHAN0409JITTRAPON0604000107081983112008012100201130101401YPN03N020107ËéÒÇËÒ­0406¨ÔµÃÀ³06040001070819831120080120903¹ÒÂ100201130101401YID03ID101020102133320800389907PA03A01012360 Á.4 ËéÍ§1 µ.ÁÒºÂÒ§¾Ã0217Í.»ÅÇ¡á´§ ¨.ÃÐÂÍ§0305211400702TH0805211401201R130820170831PA03A020145ÍÑ·ÊØÁÔà·ç¤ (»ÃÐà·Èä·Â)àÅ¢·Õè60/1 ÍÒ¤ÒÃ¹Ô¤ÁÍØ0225µÏ ÊÂÒÁÍÕÊà·ÔÃì¹ ËÁÙè·Õè30407»ÅÇ¡á´§0508ÁÒºÂÒ§¾Ã0605ÃÐÂÍ§0702TH080521140130820160722PA03A03013560/1 Á.3 µ.ÁÒºÂÒ§¾Ã Í.»ÅÇ¡á´§ ÃÐÂÍ§130820151231PA03A04013866/72 Á.4 µ.ÁÒºÂÒ§¾Ã Í.»ÅÇ¡á´§ ¨.ÃÐÂÍ§080521140130820150820TL04T0010208BANK # 1040205050110603THB0808201209030908201512281008201512281108201512311205300001301020013210398422023623021128210000020010000000000003008201512313108201506013303231HS04T001010820150601020300003053000004042752HS04T001010820150701020300003053000004041905HS04T001010820150801020300003053000004041058HS04T0010108201509010203000030530000040274HS04T0010108201510010203001030530000040275HS04T0010108201511010203002030530000040275TL04T0020208BANK # 2040227050110603THB08082018030909082018032911082018033112067204451306751360200132104951722028123021028030003008201803313108201803314003ISU4108DMAX HI5TL04T0030208BANK # 2040227050110603THB0808201512300908201803041008201803091108201803311206640367130102001321049517220272230211285400000000000000000000000000000000000000000000000000000029300000000000000000000000000000003008201803313108201512314003ISU4108DMAX HI5HS04T003010820160301020300003066403670406656642HS04T003010820160401020300003066403670406647125HS04T003010820160501020300003066403670406637608HS04T003010820160601020300003066403670406637608HS04T003010820160701020300003066403670406618574HS04T003010820160801020300003066403670406609057HS04T003010820160901020300003066403670406599540HS04T003010820161001020300003066403670406590023HS04T003010820161101020300003066403670406580506HS04T003010820161201020300003066403670406580506HS04T003010820170101020300003066403670406561472HS04T003010820170201020300003066403670406561472HS04T003010820170301020300003066403670406542438HS04T003010820170401020300003066403670406542438HS04T003010820170501020300003066403670406523404HS04T003010820170601020300003066403670406523404HS04T003010820170701020300003066403670406504370HS04T003010820170801020300003066403670406494853HS04T003010820170901020300003066403670406485336HS04T003010820171001020300003066403670406475819HS04T003010820171101020300003066403670406475819HS04T003010820171201020300003066403670406466302HS04T003010820180101020300003066403670406447268HS04T003010820180201020300003066403670406447268TL04T0040220CONSUMER FINANCE # 1040205050110603THB08082017050909082017110610082017110611082017112012044990130102001321038322201623021128210000000000000000000003008201711203108201705203205555554004OPPO4103A37HS04T00401082017050102030000304499004044990HS04T00401082017060102030000304499004044151HS04T00401082017070102030000304499004043326HS04T00401082017080102030000304499004042494HS04T00401082017090102030000304499004041662HS04T0040108201710010203000030449900403830TL04T0050220CONSUMER FINANCE # 1040205050110603THB0808201705010908201711061008201711061108201711201205127921301020013210421322201623021128210000000000000000000003008201711203108201705203205555554004SAMS411040J5200AKXHS04T0050108201705010203000030512792040512792HS04T0050108201706010203000030512792040510660HS04T005010820170701020300003051279204048528HS04T005010820170801020300003051279204046396HS04T005010820170901020300003051279204044264HS04T005010820171001020300003051279204042132TL04T0060220CONSUMER FINANCE # 1040205050110603THB08082016110709082017050410082017050411082017052012045290130102001321038822201623021128210000000000000000000003008201705203108201611204004OPPO4103A374203Z40HS04T00601082016110102030000304529004045290HS04T00601082016120102030000304529004044408HS04T00601082017010102030000304529004043526HS04T00601082017020102030000304529004042644HS04T00601082017030102030000304529004041762HS04T0060108201704010203000030452900403880TL04T0070220CONSUMER FINANCE # 1040205050110603THB08082015110109082016050410082016050411082016052012044990130102001321038322201623021128210000000000000000000003008201605203108201511204004SHER4106SB66TT4203Z40HS04T00701082015110102030000304499004044990HS04T00701082015120102030000304499004044158HS04T00701082016010102030000304499004043326HS04T00701082016020102030000304499004042494HS04T00701082016030102030000304499004041662HS04T0070108201604010203000030449900403830TL04T0080220CONSUMER FINANCE # 1040205050110603THB0808201510300908201608021008201608021108201608201205104861301020013210413002201923021128300000000000000000000000000000003008201608203108201511204004SAMS4102J74203Z40HS04T0080108201511010203000030510486040510533HS04T008010820151201020300003051048604049456HS04T008010820160101020300003051048604048361HS04T008010820160201020300003051048604047243HS04T008010820160301020300003051048604046086HS04T008010820160401020300003051048604044912HS04T008010820160501020300003051048604043712HS04T008010820160601020300003051048604042487HS04T008010820160701020300003051048604041231TL04T0090220CONSUMER FINANCE # 1040204050110603THB0808201507220908201803041108201803201205190001305130972302102854  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N2942  N  N  N  N  N  N  N  N  N  N  N  N  N  N30082018032031082015082032055555537013HS04T0090108201603010203  N030515000040514466HS04T0090108201604010203  N030515000040514089HS04T0090108201605010203  N030515000040513699HS04T0090108201606010203  N030515000040513329HS04T0090108201607010203  N030515000040512959HS04T0090108201608010203  N030515000040512610HS04T0090108201609010203  N030515000040512268HS04T0090108201610010203  N030515000040511927HS04T0090108201611010203  N030519000040511605HS04T0090108201612010203  N030519000040511283HS04T0090108201701010203  N030519000040516098HS04T0090108201702010203  N030519000040515771HS04T0090108201703010203  N030519000040515414HS04T0090108201704010203  N030519000040515101HS04T0090108201705010203  N030519000040514785HS04T0090108201706010203  N030519000040514386HS04T0090108201707010203  N030519000040513987HS04T0090108201708010203  N030519000040513609HS04T0090108201709010203  N030519000040513516HS04T0090108201710010203  N030519000040513413HS04T0090108201711010203  N030519000040513321HS04T0090108201712010203  N030519000040513309HS04T0090108201801010203  N030519000040513219HS04T0090108201802010203  N030519000040513217TL04T0100214LEASING/HP # 1040221050110603THB080820170801090820180306110820180331120595760130577140200132104266022023623021028240000000000000000000000003008201803313108201708314006ÎÍ¹´éÒ4113ACF110BTH 2THHS04T0100108201708010203000030595760040595760HS04T0100108201709010203000030595760040593100HS04T0100108201710010203000030595760040590440HS04T0100108201711010203000030595760040587780HS04T0100108201712010203000030595760040585120HS04T0100108201801010203000030595760040582460HS04T0100108201802010203000030595760040579800IQ04I00101082018041702062229320404BANK0502010703THBIQ04I00201082018041102061144360416CONSUMER FINANCE050201060110703THBIQ04I00301082018040902061952130416CONSUMER FINANCE0502010703THBIQ04I00401082018032902061438220404BANK0502010703THBIQ04I00501082018012002060754240416CONSUMER FINANCE0502020703THBIQ04I00601082017092002061629250416CONSUMER FINANCE0502020703THBIQ04I00701082017073102061320500410LEASING/HP0502010703THBIQ04I00801082017071202061558530404BANK0502010703THBIQ04I00901082017050902061020340416CONSUMER FINANCE050202060110703THBIQ04I01001082017032702061757310410LEASING/HP0502010703THBIQ04I01101082017031602060904280416CONSUMER FINANCE0502020703THBIQ04I01201082016102802060903480416CONSUMER FINANCE0502020703THBIQ04I01301082016100402061348500416CONSUMER FINANCE0502010703THBIQ04I01401082016090902061657420416CONSUMER FINANCE0502020703THBIQ04I01501082016072202061652030404BANK0502010703THBIQ04I01601082016071502061049010404BANK0502010703THBIQ04I01701082016062902061657060416CONSUMER FINANCE0502010703THBIQ04I01801082016062802061622010404BANK0502010703THBIQ04I01901082016062802061456580416CONSUMER FINANCE0502010703THBIQ04I02001082016062702061439570416CONSUMER FINANCE050201060110703THBIQ04I02101082016062002060951230404BANK0502010703THBIQ04I02201082016061602061116450404BANK0502010703THBIQ04I02301082016042902060905480416CONSUMER FINANCE0502010703THBIQ04I02401082016030402061358220416CONSUMER FINANCE0502010703THBES05083620102**'
      const expected = {
        header: {
          segmentTag: 'TUEF',
          version: 14,
          memberReferenceNo: '',
          country: 'TH',
          memberCode: 'CC16021002',
          subjectReferenceCode: 1,
          enquiryControlNumber: 582345217,
        },
        PN: [
          {
            segmentTag: 'N01',
            lastName1: 'HAOHAN',
            firstName: 'JITTRAPON',
            maritalStatus: 1,
            dateOfBirth: 19831120,
            gender: 2,
            nationality: '01',
            occupation: '0',
            consentToEnquire: 'Y',
          },
          {
            segmentTag: 'N02',
            lastName1: 'ห้าวหาญ',
            firstName: 'จิตรภณ',
            maritalStatus: 1,
            dateOfBirth: 19831120,
            gender: 2,
            title: 'นาย',
            nationality: '01',
            occupation: '0',
            consentToEnquire: 'Y',
          },
        ],
        ID: [{ segmentTag: 'ID1', idType: 1, idNumber: '3320800389907' }],
        PA: [
          {
            segmentTag: 'A01',
            addressLine1: '60 ม.4 ห้อง1 ต.มาบยางพร',
            addressLine2: 'อ.ปลวกแดง จ.ระยอง',
            addressLine3: '21140',
            country: 'TH',
            postalCode: 21140,
            residentialStatus: 'R',
            reportedDate: 20170831,
          },
          {
            segmentTag: 'A02',
            addressLine1: 'อัทสุมิเท็ค (ประเทศไทย)เลขที่60/1 อาคารนิคมอุ',
            addressLine2: 'ตฯ สยามอีสเทิร์น หมู่ที่3',
            subDistrict: 'ปลวกแดง',
            district: 'มาบยางพร',
            province: 'ระยอง',
            country: 'TH',
            postalCode: 21140,
            reportedDate: 20160722,
          },
          {
            segmentTag: 'A03',
            addressLine1: '60/1 ม.3 ต.มาบยางพร อ.ปลวกแดง ระยอง',
            reportedDate: 20151231,
          },
          {
            segmentTag: 'A04',
            addressLine1: '66/72 ม.4 ต.มาบยางพร อ.ปลวกแดง จ.ระยอง',
            postalCode: 21140,
            reportedDate: 20150820,
          },
        ],
        TL: [
          {
            segmentTag: 'T001',
            memberShortName: 'BANK # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20120903,
            dateOfLastPayment: 20151228,
            dateAccountClosed: 20151228,
            asOfDate: 20151231,
            creditLimit: 30000,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 984,
            installmentNumberOfPayment: 36,
            accountStatus: 11,
            paymentHistory1: '000002001000000000000',
            paymentHistoryStartDate: 20151231,
            paymentHistoryEndDate: 20150601,
            collateral1: 231,
            childSegment: {
              HS: [
                {
                  segmentTag: 'T001',
                  asOfDate: 20150601,
                  overDueMonth: '000',
                  creditLimit: 30000,
                  amountOwed: 2752,
                },
                {
                  segmentTag: 'T001',
                  asOfDate: 20150701,
                  overDueMonth: '000',
                  creditLimit: 30000,
                  amountOwed: 1905,
                },
                {
                  segmentTag: 'T001',
                  asOfDate: 20150801,
                  overDueMonth: '000',
                  creditLimit: 30000,
                  amountOwed: 1058,
                },
                {
                  segmentTag: 'T001',
                  asOfDate: 20150901,
                  overDueMonth: '000',
                  creditLimit: 30000,
                  amountOwed: 74,
                },
                {
                  segmentTag: 'T001',
                  asOfDate: 20151001,
                  overDueMonth: '001',
                  creditLimit: 30000,
                  amountOwed: 75,
                },
                {
                  segmentTag: 'T001',
                  asOfDate: 20151101,
                  overDueMonth: '002',
                  creditLimit: 30000,
                  amountOwed: 75,
                },
              ],
            },
          },
          {
            segmentTag: 'T002',
            memberShortName: 'BANK # 2',
            accountType: 27,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20180309,
            dateOfLastPayment: 20180329,
            asOfDate: 20180331,
            creditLimit: 720445,
            amountOwed: 751360,
            installmentFreq: 3,
            installmentAmount: 9517,
            installmentNumberOfPayment: 81,
            accountStatus: 10,
            paymentHistory1: '000',
            paymentHistoryStartDate: 20180331,
            paymentHistoryEndDate: 20180331,
            unitMake: 'ISU',
            unitModel: 'DMAX HI5',
            childSegment: { HS: [] },
          },
          {
            segmentTag: 'T003',
            memberShortName: 'BANK # 2',
            accountType: 27,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20151230,
            dateOfLastPayment: 20180304,
            dateAccountClosed: 20180309,
            asOfDate: 20180331,
            creditLimit: 640367,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 9517,
            installmentNumberOfPayment: 72,
            accountStatus: 11,
            paymentHistory1:
              '000000000000000000000000000000000000000000000000000000',
            paymentHistory2: '000000000000000000000000000000',
            paymentHistoryStartDate: 20180331,
            paymentHistoryEndDate: 20151231,
            unitMake: 'ISU',
            unitModel: 'DMAX HI5',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T003',
                  asOfDate: 20160301,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 656642,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160401,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 647125,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160501,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 637608,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160601,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 637608,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160701,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 618574,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160801,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 609057,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20160901,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 599540,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20161001,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 590023,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20161101,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 580506,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20161201,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 580506,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170101,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 561472,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170201,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 561472,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170301,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 542438,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170401,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 542438,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170501,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 523404,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170601,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 523404,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170701,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 504370,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170801,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 494853,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20170901,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 485336,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20171001,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 475819,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20171101,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 475819,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20171201,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 466302,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20180101,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 447268,
                },
                {
                  segmentTag: 'T003',
                  asOfDate: 20180201,
                  overDueMonth: '000',
                  creditLimit: 640367,
                  amountOwed: 447268,
                },
              ],
            },
          },
          {
            segmentTag: 'T004',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20170509,
            dateOfLastPayment: 20171106,
            dateAccountClosed: 20171106,
            asOfDate: 20171120,
            creditLimit: 4990,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 832,
            installmentNumberOfPayment: 6,
            accountStatus: 11,
            paymentHistory1: '000000000000000000000',
            paymentHistoryStartDate: 20171120,
            paymentHistoryEndDate: 20170520,
            loanObjective: 55555,
            unitMake: 'OPPO',
            unitModel: 'A37',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T004',
                  asOfDate: 20170501,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 4990,
                },
                {
                  segmentTag: 'T004',
                  asOfDate: 20170601,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 4151,
                },
                {
                  segmentTag: 'T004',
                  asOfDate: 20170701,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 3326,
                },
                {
                  segmentTag: 'T004',
                  asOfDate: 20170801,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 2494,
                },
                {
                  segmentTag: 'T004',
                  asOfDate: 20170901,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 1662,
                },
                {
                  segmentTag: 'T004',
                  asOfDate: 20171001,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 830,
                },
              ],
            },
          },
          {
            segmentTag: 'T005',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20170501,
            dateOfLastPayment: 20171106,
            dateAccountClosed: 20171106,
            asOfDate: 20171120,
            creditLimit: 12792,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 2132,
            installmentNumberOfPayment: 6,
            accountStatus: 11,
            paymentHistory1: '000000000000000000000',
            paymentHistoryStartDate: 20171120,
            paymentHistoryEndDate: 20170520,
            loanObjective: 55555,
            unitMake: 'SAMS',
            unitModel: '40J5200AKX',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T005',
                  asOfDate: 20170501,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 12792,
                },
                {
                  segmentTag: 'T005',
                  asOfDate: 20170601,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 10660,
                },
                {
                  segmentTag: 'T005',
                  asOfDate: 20170701,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 8528,
                },
                {
                  segmentTag: 'T005',
                  asOfDate: 20170801,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 6396,
                },
                {
                  segmentTag: 'T005',
                  asOfDate: 20170901,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 4264,
                },
                {
                  segmentTag: 'T005',
                  asOfDate: 20171001,
                  overDueMonth: '000',
                  creditLimit: 12792,
                  amountOwed: 2132,
                },
              ],
            },
          },
          {
            segmentTag: 'T006',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20161107,
            dateOfLastPayment: 20170504,
            dateAccountClosed: 20170504,
            asOfDate: 20170520,
            creditLimit: 5290,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 882,
            installmentNumberOfPayment: 6,
            accountStatus: 11,
            paymentHistory1: '000000000000000000000',
            paymentHistoryStartDate: 20170520,
            paymentHistoryEndDate: 20161120,
            unitMake: 'OPPO',
            unitModel: 'A37',
            creditTypeFlag: 'Z40',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T006',
                  asOfDate: 20161101,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 5290,
                },
                {
                  segmentTag: 'T006',
                  asOfDate: 20161201,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 4408,
                },
                {
                  segmentTag: 'T006',
                  asOfDate: 20170101,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 3526,
                },
                {
                  segmentTag: 'T006',
                  asOfDate: 20170201,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 2644,
                },
                {
                  segmentTag: 'T006',
                  asOfDate: 20170301,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 1762,
                },
                {
                  segmentTag: 'T006',
                  asOfDate: 20170401,
                  overDueMonth: '000',
                  creditLimit: 5290,
                  amountOwed: 880,
                },
              ],
            },
          },
          {
            segmentTag: 'T007',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20151101,
            dateOfLastPayment: 20160504,
            dateAccountClosed: 20160504,
            asOfDate: 20160520,
            creditLimit: 4990,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 832,
            installmentNumberOfPayment: 6,
            accountStatus: 11,
            paymentHistory1: '000000000000000000000',
            paymentHistoryStartDate: 20160520,
            paymentHistoryEndDate: 20151120,
            unitMake: 'SHER',
            unitModel: 'SB66TT',
            creditTypeFlag: 'Z40',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T007',
                  asOfDate: 20151101,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 4990,
                },
                {
                  segmentTag: 'T007',
                  asOfDate: 20151201,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 4158,
                },
                {
                  segmentTag: 'T007',
                  asOfDate: 20160101,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 3326,
                },
                {
                  segmentTag: 'T007',
                  asOfDate: 20160201,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 2494,
                },
                {
                  segmentTag: 'T007',
                  asOfDate: 20160301,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 1662,
                },
                {
                  segmentTag: 'T007',
                  asOfDate: 20160401,
                  overDueMonth: '000',
                  creditLimit: 4990,
                  amountOwed: 830,
                },
              ],
            },
          },
          {
            segmentTag: 'T008',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 5,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20151030,
            dateOfLastPayment: 20160802,
            dateAccountClosed: 20160802,
            asOfDate: 20160820,
            creditLimit: 10486,
            amountOwed: 0,
            installmentFreq: 3,
            installmentAmount: 1300,
            installmentNumberOfPayment: 9,
            accountStatus: 11,
            paymentHistory1: '000000000000000000000000000000',
            paymentHistoryStartDate: 20160820,
            paymentHistoryEndDate: 20151120,
            unitMake: 'SAMS',
            unitModel: 'J7',
            creditTypeFlag: 'Z40',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T008',
                  asOfDate: 20151101,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 10533,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20151201,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 9456,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160101,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 8361,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160201,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 7243,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160301,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 6086,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160401,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 4912,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160501,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 3712,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160601,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 2487,
                },
                {
                  segmentTag: 'T008',
                  asOfDate: 20160701,
                  overDueMonth: '000',
                  creditLimit: 10486,
                  amountOwed: 1231,
                },
              ],
            },
          },
          {
            segmentTag: 'T009',
            memberShortName: 'CONSUMER FINANCE # 1',
            accountType: 4,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20150722,
            dateOfLastPayment: 20180304,
            asOfDate: 20180320,
            creditLimit: 19000,
            amountOwed: 13097,
            accountStatus: 10,
            paymentHistory1:
              'N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N',
            paymentHistory2: 'N  N  N  N  N  N  N  N  N  N  N  N  N  N',
            paymentHistoryStartDate: 20180320,
            paymentHistoryEndDate: 20150820,
            loanObjective: 55555,
            percentPayment: 3,
            childSegment: {
              HS: [
                {
                  segmentTag: 'T009',
                  asOfDate: 20160301,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 14466,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160401,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 14089,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160501,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 13699,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160601,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 13329,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160701,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 12959,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160801,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 12610,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20160901,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 12268,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20161001,
                  overDueMonth: 'N',
                  creditLimit: 15000,
                  amountOwed: 11927,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20161101,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 11605,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20161201,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 11283,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170101,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 16098,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170201,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 15771,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170301,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 15414,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170401,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 15101,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170501,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 14785,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170601,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 14386,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170701,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13987,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170801,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13609,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20170901,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13516,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20171001,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13413,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20171101,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13321,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20171201,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13309,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20180101,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13219,
                },
                {
                  segmentTag: 'T009',
                  asOfDate: 20180201,
                  overDueMonth: 'N',
                  creditLimit: 19000,
                  amountOwed: 13217,
                },
              ],
            },
          },
          {
            segmentTag: 'T010',
            memberShortName: 'LEASING/HP # 1',
            accountType: 21,
            ownershipIndicator: '1',
            currencyCode: 'THB',
            dateAccountOpened: 20170801,
            dateOfLastPayment: 20180306,
            asOfDate: 20180331,
            creditLimit: 95760,
            amountOwed: 77140,
            installmentFreq: 3,
            installmentAmount: 2660,
            installmentNumberOfPayment: 36,
            accountStatus: 10,
            paymentHistory1: '000000000000000000000000',
            paymentHistoryStartDate: 20180331,
            paymentHistoryEndDate: 20170831,
            unitMake: 'ฮอนด้า',
            unitModel: 'ACF110BTH 2TH',
            childSegment: {
              HS: [
                {
                  segmentTag: 'T010',
                  asOfDate: 20170801,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 95760,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20170901,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 93100,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20171001,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 90440,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20171101,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 87780,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20171201,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 85120,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20180101,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 82460,
                },
                {
                  segmentTag: 'T010',
                  asOfDate: 20180201,
                  overDueMonth: '000',
                  creditLimit: 95760,
                  amountOwed: 79800,
                },
              ],
            },
          },
        ],
        IQ: [
          {
            segmentTag: 'I001',
            dateOfEnquiry: 20180417,
            timeOfEnquiry: 222932,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I002',
            dateOfEnquiry: 20180411,
            timeOfEnquiry: 114436,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            enquiryAmount: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I003',
            dateOfEnquiry: 20180409,
            timeOfEnquiry: 195213,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I004',
            dateOfEnquiry: 20180329,
            timeOfEnquiry: 143822,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I005',
            dateOfEnquiry: 20180120,
            timeOfEnquiry: 75424,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I006',
            dateOfEnquiry: 20170920,
            timeOfEnquiry: 162925,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I007',
            dateOfEnquiry: 20170731,
            timeOfEnquiry: 132050,
            memberCodeShortName: 'LEASING/HP',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I008',
            dateOfEnquiry: 20170712,
            timeOfEnquiry: 155853,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I009',
            dateOfEnquiry: 20170509,
            timeOfEnquiry: 102034,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            enquiryAmount: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I010',
            dateOfEnquiry: 20170327,
            timeOfEnquiry: 175731,
            memberCodeShortName: 'LEASING/HP',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I011',
            dateOfEnquiry: 20170316,
            timeOfEnquiry: 90428,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I012',
            dateOfEnquiry: 20161028,
            timeOfEnquiry: 90348,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I013',
            dateOfEnquiry: 20161004,
            timeOfEnquiry: 134850,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I014',
            dateOfEnquiry: 20160909,
            timeOfEnquiry: 165742,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 2,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I015',
            dateOfEnquiry: 20160722,
            timeOfEnquiry: 165203,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I016',
            dateOfEnquiry: 20160715,
            timeOfEnquiry: 104901,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I017',
            dateOfEnquiry: 20160629,
            timeOfEnquiry: 165706,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I018',
            dateOfEnquiry: 20160628,
            timeOfEnquiry: 162201,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I019',
            dateOfEnquiry: 20160628,
            timeOfEnquiry: 145658,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I020',
            dateOfEnquiry: 20160627,
            timeOfEnquiry: 143957,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            enquiryAmount: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I021',
            dateOfEnquiry: 20160620,
            timeOfEnquiry: 95123,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I022',
            dateOfEnquiry: 20160616,
            timeOfEnquiry: 111645,
            memberCodeShortName: 'BANK',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I023',
            dateOfEnquiry: 20160429,
            timeOfEnquiry: 90548,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
          {
            segmentTag: 'I024',
            dateOfEnquiry: 20160304,
            timeOfEnquiry: 135822,
            memberCodeShortName: 'CONSUMER FINANCE',
            enquiryPurpose: 1,
            currencyCode: 'THB',
          },
        ],
        DR: [],
      }

      expect(parseTuef(spec, str)).toEqual(expected)
    })
  })
})
